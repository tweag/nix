<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Nix: Primops</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Nix<span id="projectnumber">&#160;2.22.0</span>
   </div>
   <div id="projectbrief">Nix, the purely functional package manager: C API (experimental)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__primops.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Primops<div class="ingroups"><a class="el" href="group__libexpr.html">libexpr</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Create your own primops.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga2e435859eef601a50aadd3c39e50f2e2"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="group__primops.html#ga2e435859eef601a50aadd3c39e50f2e2">PrimOp</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__primops.html#ga2e435859eef601a50aadd3c39e50f2e2">PrimOp</a></td></tr>
<tr class="memdesc:ga2e435859eef601a50aadd3c39e50f2e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">PrimOp function.  <br /></td></tr>
<tr class="separator:ga2e435859eef601a50aadd3c39e50f2e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga17365c66df7f598a3c606aa4aec7c1e5"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__primops.html#ga17365c66df7f598a3c606aa4aec7c1e5">PrimOpFun</a>) (void *user_data, <a class="el" href="structnix__c__context.html">nix_c_context</a> *context, <a class="el" href="structEvalState.html">EvalState</a> *state, <a class="el" href="structValue.html">Value</a> **args, <a class="el" href="structValue.html">Value</a> *ret)</td></tr>
<tr class="memdesc:ga17365c66df7f598a3c606aa4aec7c1e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function pointer for primops When you want to return an error, call nix_set_err_msg(context, NIX_ERR_UNKNOWN, "your error message here").  <br /></td></tr>
<tr class="separator:ga17365c66df7f598a3c606aa4aec7c1e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga5bf66d0453a6c978b34c23215b4cb4b4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__primops.html#ga2e435859eef601a50aadd3c39e50f2e2">PrimOp</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__primops.html#ga5bf66d0453a6c978b34c23215b4cb4b4">nix_alloc_primop</a> (<a class="el" href="structnix__c__context.html">nix_c_context</a> *context, <a class="el" href="group__primops.html#ga17365c66df7f598a3c606aa4aec7c1e5">PrimOpFun</a> fun, int arity, const char *name, const char **args, const char *doc, void *user_data)</td></tr>
<tr class="memdesc:ga5bf66d0453a6c978b34c23215b4cb4b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a PrimOp.  <br /></td></tr>
<tr class="separator:ga5bf66d0453a6c978b34c23215b4cb4b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga308d3d195090455a3c2383bb4f46243e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__errors.html#ga76b77b272051ad446bd1d87f5d471081">nix_err</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__primops.html#ga308d3d195090455a3c2383bb4f46243e">nix_register_primop</a> (<a class="el" href="structnix__c__context.html">nix_c_context</a> *context, <a class="el" href="group__primops.html#ga2e435859eef601a50aadd3c39e50f2e2">PrimOp</a> *primOp)</td></tr>
<tr class="memdesc:ga308d3d195090455a3c2383bb4f46243e"><td class="mdescLeft">&#160;</td><td class="mdescRight">add a primop to the <code>builtins</code> attribute set  <br /></td></tr>
<tr class="separator:ga308d3d195090455a3c2383bb4f46243e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Create your own primops. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga2e435859eef601a50aadd3c39e50f2e2" name="ga2e435859eef601a50aadd3c39e50f2e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2e435859eef601a50aadd3c39e50f2e2">&#9670;&#160;</a></span>PrimOp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="group__primops.html#ga2e435859eef601a50aadd3c39e50f2e2">PrimOp</a> <a class="el" href="group__primops.html#ga2e435859eef601a50aadd3c39e50f2e2">PrimOp</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PrimOp function. </p>
<p>Owned by the GC </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__primops.html#ga5bf66d0453a6c978b34c23215b4cb4b4" title="Allocate a PrimOp.">nix_alloc_primop</a>, <a class="el" href="group__value__manip.html#ga5138834e516251ad6e5dde138fe98461" title="Set primop.">nix_init_primop</a> </dd></dl>

</div>
</div>
<a id="ga17365c66df7f598a3c606aa4aec7c1e5" name="ga17365c66df7f598a3c606aa4aec7c1e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga17365c66df7f598a3c606aa4aec7c1e5">&#9670;&#160;</a></span>PrimOpFun</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* PrimOpFun) (void *user_data, <a class="el" href="structnix__c__context.html">nix_c_context</a> *context, <a class="el" href="structEvalState.html">EvalState</a> *state, <a class="el" href="structValue.html">Value</a> **args, <a class="el" href="structValue.html">Value</a> *ret)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function pointer for primops When you want to return an error, call nix_set_err_msg(context, NIX_ERR_UNKNOWN, "your error message here"). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user_data</td><td>Arbitrary data that was initially supplied to nix_alloc_primop </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">context</td><td>Stores error information. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">state</td><td>Evaluator state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">args</td><td>list of arguments. Note that these can be thunks and should be forced using nix_value_force before use. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>return value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__primops.html#ga5bf66d0453a6c978b34c23215b4cb4b4" title="Allocate a PrimOp.">nix_alloc_primop</a>, <a class="el" href="group__value__manip.html#ga5138834e516251ad6e5dde138fe98461" title="Set primop.">nix_init_primop</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga5bf66d0453a6c978b34c23215b4cb4b4" name="ga5bf66d0453a6c978b34c23215b4cb4b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5bf66d0453a6c978b34c23215b4cb4b4">&#9670;&#160;</a></span>nix_alloc_primop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__primops.html#ga2e435859eef601a50aadd3c39e50f2e2">PrimOp</a> * nix_alloc_primop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnix__c__context.html">nix_c_context</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__primops.html#ga17365c66df7f598a3c606aa4aec7c1e5">PrimOpFun</a>&#160;</td>
          <td class="paramname"><em>fun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>arity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>doc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate a PrimOp. </p>
<p>Owned by the garbage collector. Use <a class="el" href="group__GC.html#ga9acf9577b88003b7a17bcf2c1d0f7d1c" title="Decrement the garbage collector reference counter for the given object.">nix_gc_decref()</a> when you're done with the returned PrimOp.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">context</td><td>Optional, stores error information </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fun</td><td>callback </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arity</td><td>expected number of function arguments </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>function name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">args</td><td>array of argument names, NULL-terminated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">doc</td><td>optional, documentation for this primop </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">user_data</td><td>optional, arbitrary data, passed to the callback when it's called </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>primop, or null in case of errors </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__value__manip.html#ga5138834e516251ad6e5dde138fe98461" title="Set primop.">nix_init_primop</a> </dd></dl>

</div>
</div>
<a id="ga308d3d195090455a3c2383bb4f46243e" name="ga308d3d195090455a3c2383bb4f46243e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga308d3d195090455a3c2383bb4f46243e">&#9670;&#160;</a></span>nix_register_primop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__errors.html#ga76b77b272051ad446bd1d87f5d471081">nix_err</a> nix_register_primop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnix__c__context.html">nix_c_context</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__primops.html#ga2e435859eef601a50aadd3c39e50f2e2">PrimOp</a> *&#160;</td>
          <td class="paramname"><em>primOp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>add a primop to the <code>builtins</code> attribute set </p>
<p>Only applies to States created after this call.</p>
<p>Moves your PrimOp content into the global evaluator registry, meaning your input PrimOp pointer is no longer usable. You are free to remove your references to it, after which it will be garbage collected.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">context</td><td>Optional, stores error information </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>primop, or null in case of errors </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
